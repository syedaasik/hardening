opensuse:~ # cat /etc/pam.d/sshd 
#%PAM-1.0
auth        requisite   pam_nologin.so
auth        required    pam_tally2.so deny=5 onerr=fail unlock_time=600 audit
auth        include     common-auth

account     requisite   pam_nologin.so
account     required    pam_tally2.so audit
account     include     common-account

password    include     common-password

session     required    pam_loginuid.so
session     optional    pam_keyinit.so   force revoke
session     include     common-session
session     optional    pam_motd.so


opensuse:~ # cat /etc/ssh/sshd_config | egrep -v '#|^$'
Include /etc/ssh/sshd_config.d/*.conf
Include /usr/etc/ssh/sshd_config.d/*.conf
Banner	/etc/issue
PermitRootLogin no
AuthorizedKeysFile	.ssh/authorized_keys
AllowGroups sshusers
UsePAM yes
X11Forwarding yes
PrintMotd no
Subsystem	sftp	/usr/lib/ssh/sftp-server
AcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES
AcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT
AcceptEnv LC_IDENTIFICATION LC_ALL

cat /etc/issue
***************************************************************
*                WARNING: ACCESS RESTRICTED                   *
* This system is for AUTHORIZED USERS ONLY.                   *
* All activities are monitored and logged.                    *
* Unauthorized access is STRICTLY PROHIBITED and may lead to  *
* disciplinary action, prosecution, or both.                  *
***************************************************************


opensuse:~ # cat /etc/sudoers.d/cmds 
Cmnd_Alias DEV_CMDS = /opt/tomcat11/bin/./startup.sh, \
                      /opt/tomcat11/bin/./shutdown.sh, \
                      /usr/bin/npm install, \
                      /usr/bin/npm run build, \ 
                      /usr/bin/npm cache --force, \ 
                      /usr/bin/npm uninstall, \
                      /usr/bin/pm2 stop, \
                      /usr/bin/pm2 list, \ 
                      /usr/bin/pm2 status, \ 
                      /usr/bin/pm2 delete, \ 
                      /usr/bin/pm2 show, \ 
                      /usr/bin/pm2 log 
opensuse:~ # 
opensuse:~ # cat /etc/sudoers.d/developers 
%developers	ALL=(ALL)	NOPASSWD: DEV_CMDS 


recommendation
-> security tightening [user levels]
   -> sudo policies
   -> pam policies
   -> ssh hardening
   -> user policies 
   -> credential expiries
   -> ssh key based authentication [long term perspective]
   -> monitoring metrics packages
   
   
-> partitioning
   -> assigning specific storage for data disk and application disk. [Isolating OS from app and data]
   -> server name nomenclature [ prod, development ]
   -> user name nomenclature 

-> patching 
   -> patch flow dev and production 
